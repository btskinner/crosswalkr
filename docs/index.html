<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rename and Encode Data Frames Using External Crosswalk Files • crosswalkr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Rename and Encode Data Frames Using External Crosswalk Files">
<meta property="og:description" content="A pair of functions for renaming and encoding data frames
	     using external crosswalk files. It is especially useful when
	     constructing master data sets from multiple smaller data
	     sets that do not name or encode variables consistently
	     across files. Based on similar commands in 'Stata'.">
<meta property="og:image" content="https://www.btskinner.me/crosswalkr/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">crosswalkr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/crosswalkr.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/btskinner/crosswalkr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="crosswalkr" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#crosswalkr" class="anchor"></a>crosswalkr <img src="reference/figures/logo.png" align="right">
</h1></div>

<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>This package offers a pair of functions, <code><a href="reference/renamefrom.html">renamefrom()</a></code> and <code><a href="reference/encodefrom.html">encodefrom()</a></code>, for renaming and encoding data frames using external crosswalk files. It is especially useful when constructing master data sets from multiple smaller data sets that do not name or encode variables consistently across files. Based on <code>renamefrom</code> and <code>encodefrom</code> <a href="https://github.com/slhudson/rename-and-encode">Stata commands written by Sally Hudson and team</a>.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>Install the latest release version from CRAN with</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">install.packages</span>(<span class="st">'crosswalkr'</span>)</a></code></pre></div>
<p>Install the latest development version from Github with</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">'btskinner/crosswalkr'</span>)</a></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">library</span>(crosswalkr)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">## starting data frame</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">state =</span> <span class="kw">c</span>(<span class="st">'Kentucky'</span>,<span class="st">'Tennessee'</span>,<span class="st">'Virginia'</span>),</a>
<a class="sourceLine" id="cb3-5" data-line-number="5">                 <span class="dt">fips =</span> <span class="kw">c</span>(<span class="dv">21</span>,<span class="dv">47</span>,<span class="dv">51</span>),</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">                 <span class="dt">region =</span> <span class="kw">c</span>(<span class="st">'South'</span>,<span class="st">'South'</span>,<span class="st">'South'</span>))</a>
<a class="sourceLine" id="cb3-7" data-line-number="7">df</a></code></pre></div>
<pre><code>##       state fips region
## 1  Kentucky   21  South
## 2 Tennessee   47  South
## 3  Virginia   51  South</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co">## crosswalk with which to convert old names to new names with labels</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">cw &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">old_name =</span> <span class="kw">c</span>(<span class="st">'state'</span>,<span class="st">'fips'</span>),</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">                 <span class="dt">new_name =</span> <span class="kw">c</span>(<span class="st">'stname'</span>,<span class="st">'stfips'</span>),</a>
<a class="sourceLine" id="cb5-4" data-line-number="4">                 <span class="dt">label =</span> <span class="kw">c</span>(<span class="st">'Full state name'</span>, <span class="st">'FIPS code'</span>))</a>
<a class="sourceLine" id="cb5-5" data-line-number="5">cw</a></code></pre></div>
<pre><code>##   old_name new_name           label
## 1    state   stname Full state name
## 2     fips   stfips       FIPS code</code></pre>
<div id="renaming" class="section level3">
<h3 class="hasAnchor">
<a href="#renaming" class="anchor"></a>Renaming</h3>
<p>Convert old variable names to new names and add labels from crosswalk.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">df1 &lt;-<span class="st"> </span><span class="kw"><a href="reference/renamefrom.html">renamefrom</a></span>(df, <span class="dt">cw_file =</span> cw, <span class="dt">raw =</span> old_name, <span class="dt">clean =</span> new_name, <span class="dt">label =</span> label)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">df1</a></code></pre></div>
<pre><code>##      stname stfips
## 1  Kentucky     21
## 2 Tennessee     47
## 3  Virginia     51</code></pre>
<p>Convert old variable names to new names using old names as labels (ignoring labels in crosswalk).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">df2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/renamefrom.html">renamefrom</a></span>(df, <span class="dt">cw_file =</span> cw, <span class="dt">raw =</span> old_name, <span class="dt">clean =</span> new_name, <span class="dt">name_label =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">df2</a></code></pre></div>
<pre><code>##      stname stfips
## 1  Kentucky     21
## 2 Tennessee     47
## 3  Virginia     51</code></pre>
<p>Convert old variable names to new names, but keep unmatched old names in the data frame.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">df3 &lt;-<span class="st"> </span><span class="kw"><a href="reference/renamefrom.html">renamefrom</a></span>(df, <span class="dt">cw_file =</span> cw, <span class="dt">raw =</span> old_name, <span class="dt">clean =</span> new_name, <span class="dt">drop_extra =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb11-2" data-line-number="2">df3 </a></code></pre></div>
<pre><code>##      stname stfips region
## 1  Kentucky     21  South
## 2 Tennessee     47  South
## 3  Virginia     51  South</code></pre>
</div>
<div id="encoding" class="section level3">
<h3 class="hasAnchor">
<a href="#encoding" class="anchor"></a>Encoding</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1"><span class="co">## starting data frame</span></a>
<a class="sourceLine" id="cb13-2" data-line-number="2">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">state =</span> <span class="kw">c</span>(<span class="st">'Kentucky'</span>,<span class="st">'Tennessee'</span>,<span class="st">'Virginia'</span>),</a>
<a class="sourceLine" id="cb13-3" data-line-number="3">                 <span class="dt">stfips =</span> <span class="kw">c</span>(<span class="dv">21</span>,<span class="dv">47</span>,<span class="dv">51</span>),</a>
<a class="sourceLine" id="cb13-4" data-line-number="4">                 <span class="dt">cenregnm =</span> <span class="kw">c</span>(<span class="st">'South'</span>,<span class="st">'South'</span>,<span class="st">'South'</span>))</a>
<a class="sourceLine" id="cb13-5" data-line-number="5">df</a></code></pre></div>
<pre><code>##       state stfips cenregnm
## 1  Kentucky     21    South
## 2 Tennessee     47    South
## 3  Virginia     51    South</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="co">## use state crosswalk data file from package</span></a>
<a class="sourceLine" id="cb15-2" data-line-number="2">cw &lt;-<span class="st"> </span><span class="kw">get</span>(<span class="kw">data</span>(stcrosswalk))</a>
<a class="sourceLine" id="cb15-3" data-line-number="3">cw</a></code></pre></div>
<pre><code>## # A tibble: 51 x 7
##    stfips stabbr stname               cenreg cenregnm  cendiv cendivnm          
##     &lt;int&gt; &lt;chr&gt;  &lt;chr&gt;                 &lt;int&gt; &lt;chr&gt;      &lt;int&gt; &lt;chr&gt;             
##  1      1 AL     Alabama                   3 South          6 East South Central
##  2      2 AK     Alaska                    4 West           9 Pacific           
##  3      4 AZ     Arizona                   4 West           8 Mountain          
##  4      5 AR     Arkansas                  3 South          7 West South Central
##  5      6 CA     California                4 West           9 Pacific           
##  6      8 CO     Colorado                  4 West           8 Mountain          
##  7      9 CT     Connecticut               1 Northeast      1 New England       
##  8     10 DE     Delaware                  3 South          5 South Atlantic    
##  9     11 DC     District of Columbia      3 South          5 South Atlantic    
## 10     12 FL     Florida                   3 South          5 South Atlantic    
## # ... with 41 more rows</code></pre>
<p>Create a new column with factor-encoded values</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">df<span class="op">$</span>state2 &lt;-<span class="st"> </span><span class="kw"><a href="reference/encodefrom.html">encodefrom</a></span>(df, <span class="dt">var =</span> state, <span class="dt">cw_file =</span> cw, <span class="dt">raw =</span> stname, <span class="dt">clean =</span> stfips, <span class="dt">label =</span> stabbr)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2">df</a></code></pre></div>
<pre><code>##       state stfips cenregnm state2
## 1  Kentucky     21    South     KY
## 2 Tennessee     47    South     TN
## 3  Virginia     51    South     VA</code></pre>
<p>Create a new column with labelled values.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="co">## convert to tbl_df</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2">df &lt;-<span class="st"> </span>tibble<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/tibble/topics/as_tibble">as_data_frame</a></span>(df)</a>
<a class="sourceLine" id="cb19-3" data-line-number="3">df<span class="op">$</span>state3 &lt;-<span class="st"> </span><span class="kw"><a href="reference/encodefrom.html">encodefrom</a></span>(df, <span class="dt">var =</span> state, <span class="dt">cw_file =</span> cw, <span class="dt">raw =</span> stname, <span class="dt">clean =</span> stfips, <span class="dt">label =</span> stabbr)</a></code></pre></div>
<p>Create new column with factor-encoded values (ignores the fact that <code>df</code> is a tibble)</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">df<span class="op">$</span>state4 &lt;-<span class="st"> </span><span class="kw"><a href="reference/encodefrom.html">encodefrom</a></span>(df, <span class="dt">var =</span> state, <span class="dt">cw_file =</span> cw, <span class="dt">raw =</span> stname, <span class="dt">clean =</span> stfips, <span class="dt">label =</span> stabbr, <span class="dt">ignore_tibble =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Show factors with labels:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">haven<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/haven/topics/as_factor">as_factor</a></span>(df)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 6
##   state     stfips cenregnm state2 state3 state4
##   &lt;fct&gt;      &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;fct&gt;  &lt;fct&gt; 
## 1 Kentucky      21 South    KY     KY     KY    
## 2 Tennessee     47 South    TN     TN     TN    
## 3 Virginia      51 South    VA     VA     VA</code></pre>
<p>Show factors without labels:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">haven<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/haven/topics/zap_labels">zap_labels</a></span>(df)</a></code></pre></div>
<pre><code>## # A tibble: 3 x 6
##   state     stfips cenregnm state2 state3 state4
##   &lt;fct&gt;      &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;chr&gt;  &lt;fct&gt; 
## 1 Kentucky      21 South    KY     21     KY    
## 2 Tennessee     47 South    TN     47     TN    
## 3 Virginia      51 South    VA     51     VA</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=crosswalkr">https://​cloud.r-project.org/​package=crosswalkr</a>
</li>
<li>Browse source code at <br><a href="https://github.com/btskinner/crosswalkr">https://​github.com/​btskinner/​crosswalkr</a>
</li>
<li>Report a bug at <br><a href="https://github.com/btskinner/crosswalkr/issues%20%20%20">https://​github.com/​btskinner/​crosswalkr/​issues   </a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://www.btskinner.me">Benjamin Skinner</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-0337-7415" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" height="16"></a> </li>
</ul>
</div>

      <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://travis-ci.org/btskinner/crosswalkr"><img src="https://travis-ci.org/btskinner/crosswalkr.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://github.com/btskinner/crosswalkr"><img src="https://img.shields.io/github/release/btskinner/crosswalkr.svg" alt="GitHub release"></a></li>
<li><a href="http://cran.r-project.org/package=crosswalkr"><img src="http://www.r-pkg.org/badges/version/crosswalkr" alt="CRAN_Status_Badge"></a></li>
</ul>
</div>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by <a href="https://www.btskinner.me">Benjamin Skinner</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
